import{_ as Ae,o as Le,A as We,a as g,c as fe,b as o,d as t,w as s,E as d,r as i,e as p,B as Me,u as A,L,C as W,D as k,n as u,t as c,h as Oe,q as T,x as y,P as M,I as Re}from"./main-BuGC26DR.js";const Ee={class:"admin-container"},He={class:"admin-content"},je={class:"tab-content"},Ge={class:"toolbar"},Je={class:"pagination"},Ke={class:"tab-content"},Qe={class:"toolbar"},Xe={class:"pagination"},Ye={class:"tab-content"},Ze={class:"toolbar"},et={class:"pagination"},tt={class:"tab-content"},at={class:"toolbar"},lt={class:"pagination"},st={class:"tab-content"},ot={class:"stats-grid"},rt={class:"stat-card"},nt={class:"stat-value"},dt={class:"stat-card"},it={class:"stat-value"},ut={class:"stat-card"},pt={class:"stat-value"},ct={class:"stat-card"},mt={class:"stat-value"},vt={class:"stat-card"},ft={class:"stat-value"},gt={class:"stat-card"},yt={class:"stat-value"},_t=["src"],bt={class:"dialog-footer"},wt={__name:"Admin",setup(ht){const O=i("users"),U=i([]),R=i(!1),Q=i(1),X=i(10),Y=i(0),Z=T({keyword:""}),z=i([]),E=i(!1),ee=i(1),te=i(10),ae=i(0),le=T({keyword:""}),S=i([]),H=i(!1),se=i(1),oe=i(10),re=i(0),ne=T({keyword:""}),C=i(!1),j=i(!1),V=i(),de=i([]),G=i(!1),ie=i(1),ue=i(10),pe=i(0),N=T({keyword:"",status:null}),_=i({}),r=T({title:"",description:"",teacherName:"",category:"",difficulty:null,duration:0,price:0,isFree:0,coverImage:""}),ge={title:[{required:!0,message:"请输入课程标题",trigger:"blur"}],description:[{required:!0,message:"请输入课程描述",trigger:"blur"}],teacherName:[{required:!0,message:"请输入讲师姓名",trigger:"blur"}],category:[{required:!0,message:"请选择课程分类",trigger:"change"}],difficulty:[{required:!0,message:"请选择难度等级",trigger:"change"}],duration:[{required:!0,message:"请输入课程时长",trigger:"blur"}]},ye=Re(()=>{const l=localStorage.getItem("token");return l?{Authorization:`Bearer ${l}`}:{}}),$=async()=>{R.value=!0;try{const l=[{id:1,username:"admin",nickname:"管理员",email:"admin@shengyouquan.com",points:1e3,status:1,createTime:"2024-01-01 10:00:00"},{id:2,username:"user1",nickname:"摄影师小明",email:"user1@example.com",points:500,status:1,createTime:"2024-01-02 14:30:00"}];U.value=l,Y.value=l.length}catch{d.error("加载用户列表失败")}finally{R.value=!1}},J=async()=>{E.value=!0;try{const l=[{id:1,title:"城市夜景",authorNickname:"摄影师小明",viewCount:120,likeCount:25,status:1,createTime:"2024-01-05 14:30:00"}];z.value=l,ae.value=l.length}catch{d.error("加载作品列表失败")}finally{E.value=!1}},I=async()=>{H.value=!0;try{const l=[{id:1,title:"摄影入门基础",teacherName:"张老师",price:0,isFree:1,studentCount:150,status:1},{id:2,title:"人像摄影技巧",teacherName:"李老师",price:199,isFree:0,studentCount:80,status:1}];S.value=l,re.value=l.length}catch{d.error("加载课程列表失败")}finally{H.value=!1}},F=async()=>{G.value=!0;try{const l=[{orderNo:"20240105123456",itemName:"人像摄影技巧课程",amount:199,payType:1,payStatus:1,createTime:"2024-01-05 14:30:00"},{orderNo:"20240104234567",itemName:"摄影技巧手册",amount:800,payType:2,payStatus:0,createTime:"2024-01-04 16:45:00"}];de.value=l,pe.value=l.length}catch{d.error("加载订单列表失败")}finally{G.value=!1}},_e=async()=>{try{_.value={users:156,works:234,courses:12,orders:89,totalPoints:45600,totalRevenue:12580}}catch{d.error("加载统计数据失败")}},be=async l=>{try{await y.post(`/admin/user/${l.id}/status`),l.status=l.status===1?0:1,d.success("操作成功")}catch{d.error("操作失败")}},we=async l=>{M.confirm(`确定要删除用户 "${l.username}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await y.delete(`/admin/user/${l.id}`),U.value=U.value.filter(e=>e.id!==l.id),d.success("删除成功")}catch{d.error("删除失败")}}).catch(()=>{})},he=async l=>{try{await y.post(`/admin/work/${l.id}/status`),l.status=l.status===1?0:1,d.success("操作成功")}catch{d.error("操作失败")}},ke=async l=>{M.confirm(`确定要删除作品 "${l.title}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await y.delete(`/admin/work/${l.id}`),z.value=z.value.filter(e=>e.id!==l.id),d.success("删除成功")}catch{d.error("删除失败")}}).catch(()=>{})},Ce=async l=>{try{await y.post(`/admin/course/${l.id}/status`),l.status=l.status===1?0:1,d.success("操作成功")}catch{d.error("操作失败")}},Ve=async l=>{M.confirm(`确定要删除课程 "${l.title}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await y.delete(`/admin/course/${l.id}`),S.value=S.value.filter(e=>e.id!==l.id),d.success("删除成功")}catch{d.error("删除失败")}}).catch(()=>{})},xe=async l=>{M.confirm(`确定要为订单 "${l.orderNo}" 退款吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await y.post(`/admin/order/${l.orderNo}/refund`),l.payStatus=3,d.success("退款成功")}catch{d.error("退款失败")}}).catch(()=>{})},Te=l=>{l.code===200?(r.coverImage=l.data.url,d.success("封面上传成功")):d.error(l.message||"封面上传失败")},Ue=l=>{const e=l.type.startsWith("image/"),w=l.size/1024/1024<5;return e?w?!0:(d.error("图片大小不能超过 5MB!"),!1):(d.error("只能上传图片文件!"),!1)},ze=async()=>{V.value&&await V.value.validate(async l=>{if(l){j.value=!0;try{await y.post("/admin/course/add",r),d.success("课程添加成功"),C.value=!1,ce(),I()}catch{d.error("添加课程失败")}finally{j.value=!1}}})};function ce(){r.title="",r.description="",r.teacherName="",r.category="",r.difficulty=null,r.duration=0,r.price=0,r.isFree=0,r.coverImage="",V.value&&V.value.resetFields()}const Se=l=>({1:"微信支付",2:"支付宝",3:"积分支付"})[l]||"未知",Ne=l=>({0:"info",1:"success",2:"warning",3:"danger"})[l]||"info",$e=l=>({0:"待支付",1:"已支付",2:"已取消",3:"已退款"})[l]||"未知";Le(()=>{$()});const Ie=l=>{l==="users"?$():l==="works"?J():l==="courses"?I():l==="orders"?F():l==="stats"&&_e()};return We(O,l=>{Ie(l)}),(l,e)=>{const w=p("el-icon"),b=p("el-input"),n=p("el-table-column"),B=p("el-tag"),m=p("el-button"),P=p("el-table"),q=p("el-pagination"),x=p("el-tab-pane"),v=p("el-option"),K=p("el-select"),Fe=p("el-tabs"),f=p("el-form-item"),me=p("el-input-number"),ve=p("el-radio"),Be=p("el-radio-group"),Pe=p("el-upload"),qe=p("el-form"),De=p("el-dialog"),D=Me("loading");return g(),fe("div",Ee,[e[50]||(e[50]=o("div",{class:"page-header"},[o("h2",null,"管理后台")],-1)),o("div",He,[t(Fe,{modelValue:O.value,"onUpdate:modelValue":e[15]||(e[15]=a=>O.value=a),type:"border-card"},{default:s(()=>[t(x,{name:"users",label:"用户管理"},{default:s(()=>[o("div",je,[o("div",Ge,[t(b,{modelValue:Z.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>Z.keyword=a),placeholder:"搜索用户名、昵称",style:{width:"300px"},onInput:$},{prefix:s(()=>[t(w,null,{default:s(()=>[t(A(L))]),_:1})]),_:1},8,["modelValue"])]),W((g(),k(P,{data:U.value,style:{width:"100%"}},{default:s(()=>[t(n,{prop:"id",label:"ID",width:"80"}),t(n,{prop:"username",label:"用户名",width:"120"}),t(n,{prop:"nickname",label:"昵称",width:"120"}),t(n,{prop:"email",label:"邮箱","min-width":"180"}),t(n,{prop:"points",label:"积分",width:"100"}),t(n,{prop:"status",label:"状态",width:"100"},{default:s(({row:a})=>[t(B,{type:a.status===1?"success":"danger"},{default:s(()=>[u(c(a.status===1?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"createTime",label:"注册时间",width:"180"}),t(n,{label:"操作",width:"150",fixed:"right"},{default:s(({row:a})=>[t(m,{type:"text",size:"small",onClick:h=>be(a)},{default:s(()=>[u(c(a.status===1?"禁用":"启用"),1)]),_:2},1032,["onClick"]),t(m,{type:"text",size:"small",onClick:h=>we(a)},{default:s(()=>[...e[26]||(e[26]=[u(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[D,R.value]]),o("div",Je,[t(q,{"current-page":Q.value,"onUpdate:currentPage":e[1]||(e[1]=a=>Q.value=a),"page-size":X.value,"onUpdate:pageSize":e[2]||(e[2]=a=>X.value=a),total:Y.value,onCurrentChange:$},null,8,["current-page","page-size","total"])])])]),_:1}),t(x,{name:"works",label:"作品管理"},{default:s(()=>[o("div",Ke,[o("div",Qe,[t(b,{modelValue:le.keyword,"onUpdate:modelValue":e[3]||(e[3]=a=>le.keyword=a),placeholder:"搜索作品标题",style:{width:"300px"},onInput:J},{prefix:s(()=>[t(w,null,{default:s(()=>[t(A(L))]),_:1})]),_:1},8,["modelValue"]),t(m,{type:"primary",onClick:e[4]||(e[4]=a=>l.showAddWorkDialog=!0)},{default:s(()=>[...e[27]||(e[27]=[u("添加作品",-1)])]),_:1})]),W((g(),k(P,{data:z.value,style:{width:"100%"}},{default:s(()=>[t(n,{prop:"id",label:"ID",width:"80"}),t(n,{prop:"title",label:"标题","min-width":"150"}),t(n,{prop:"authorNickname",label:"作者",width:"120"}),t(n,{prop:"viewCount",label:"浏览",width:"80"}),t(n,{prop:"likeCount",label:"点赞",width:"80"}),t(n,{prop:"status",label:"状态",width:"100"},{default:s(({row:a})=>[t(B,{type:a.status===1?"success":"info"},{default:s(()=>[u(c(a.status===1?"正常":"隐藏"),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"createTime",label:"发布时间",width:"180"}),t(n,{label:"操作",width:"150",fixed:"right"},{default:s(({row:a})=>[t(m,{type:"text",size:"small",onClick:h=>he(a)},{default:s(()=>[u(c(a.status===1?"隐藏":"显示"),1)]),_:2},1032,["onClick"]),t(m,{type:"text",size:"small",onClick:h=>ke(a)},{default:s(()=>[...e[28]||(e[28]=[u(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[D,E.value]]),o("div",Xe,[t(q,{"current-page":ee.value,"onUpdate:currentPage":e[5]||(e[5]=a=>ee.value=a),"page-size":te.value,"onUpdate:pageSize":e[6]||(e[6]=a=>te.value=a),total:ae.value,onCurrentChange:J},null,8,["current-page","page-size","total"])])])]),_:1}),t(x,{name:"courses",label:"课程管理"},{default:s(()=>[o("div",Ye,[o("div",Ze,[t(b,{modelValue:ne.keyword,"onUpdate:modelValue":e[7]||(e[7]=a=>ne.keyword=a),placeholder:"搜索课程标题",style:{width:"300px"},onInput:I},{prefix:s(()=>[t(w,null,{default:s(()=>[t(A(L))]),_:1})]),_:1},8,["modelValue"]),t(m,{type:"primary",onClick:e[8]||(e[8]=a=>C.value=!0)},{default:s(()=>[...e[29]||(e[29]=[u("添加课程",-1)])]),_:1})]),W((g(),k(P,{data:S.value,style:{width:"100%"}},{default:s(()=>[t(n,{prop:"id",label:"ID",width:"80"}),t(n,{prop:"title",label:"标题","min-width":"150"}),t(n,{prop:"teacherName",label:"讲师",width:"120"}),t(n,{prop:"price",label:"价格",width:"100"},{default:s(({row:a})=>[u(c(a.isFree===1?"免费":"¥"+a.price),1)]),_:1}),t(n,{prop:"studentCount",label:"学习人数",width:"100"}),t(n,{prop:"status",label:"状态",width:"100"},{default:s(({row:a})=>[t(B,{type:a.status===1?"success":"info"},{default:s(()=>[u(c(a.status===1?"上架":"下架"),1)]),_:2},1032,["type"])]),_:1}),t(n,{label:"操作",width:"150",fixed:"right"},{default:s(({row:a})=>[t(m,{type:"text",size:"small",onClick:h=>Ce(a)},{default:s(()=>[u(c(a.status===1?"下架":"上架"),1)]),_:2},1032,["onClick"]),t(m,{type:"text",size:"small",onClick:h=>Ve(a)},{default:s(()=>[...e[30]||(e[30]=[u(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[D,H.value]]),o("div",et,[t(q,{"current-page":se.value,"onUpdate:currentPage":e[9]||(e[9]=a=>se.value=a),"page-size":oe.value,"onUpdate:pageSize":e[10]||(e[10]=a=>oe.value=a),total:re.value,onCurrentChange:I},null,8,["current-page","page-size","total"])])])]),_:1}),t(x,{name:"orders",label:"订单管理"},{default:s(()=>[o("div",tt,[o("div",at,[t(b,{modelValue:N.keyword,"onUpdate:modelValue":e[11]||(e[11]=a=>N.keyword=a),placeholder:"搜索订单号、商品名称",style:{width:"300px"},onInput:F},{prefix:s(()=>[t(w,null,{default:s(()=>[t(A(L))]),_:1})]),_:1},8,["modelValue"]),t(K,{modelValue:N.status,"onUpdate:modelValue":e[12]||(e[12]=a=>N.status=a),placeholder:"订单状态",clearable:"",onChange:F,style:{"margin-left":"10px"}},{default:s(()=>[t(v,{label:"待支付",value:0}),t(v,{label:"已支付",value:1}),t(v,{label:"已取消",value:2}),t(v,{label:"已退款",value:3})]),_:1},8,["modelValue"])]),W((g(),k(P,{data:de.value,style:{width:"100%"}},{default:s(()=>[t(n,{prop:"orderNo",label:"订单号",width:"180"}),t(n,{prop:"itemName",label:"商品名称","min-width":"150"}),t(n,{prop:"amount",label:"金额",width:"100"},{default:s(({row:a})=>[u(" ¥"+c(a.amount),1)]),_:1}),t(n,{prop:"payType",label:"支付方式",width:"100"},{default:s(({row:a})=>[u(c(Se(a.payType)),1)]),_:1}),t(n,{prop:"payStatus",label:"状态",width:"100"},{default:s(({row:a})=>[t(B,{type:Ne(a.payStatus)},{default:s(()=>[u(c($e(a.payStatus)),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"createTime",label:"创建时间",width:"180"}),t(n,{label:"操作",width:"120",fixed:"right"},{default:s(({row:a})=>[a.payStatus===0?(g(),k(m,{key:0,type:"text",size:"small",onClick:h=>xe(a)},{default:s(()=>[...e[31]||(e[31]=[u(" 退款 ",-1)])]),_:1},8,["onClick"])):Oe("",!0)]),_:1})]),_:1},8,["data"])),[[D,G.value]]),o("div",lt,[t(q,{"current-page":ie.value,"onUpdate:currentPage":e[13]||(e[13]=a=>ie.value=a),"page-size":ue.value,"onUpdate:pageSize":e[14]||(e[14]=a=>ue.value=a),total:pe.value,onCurrentChange:F},null,8,["current-page","page-size","total"])])])]),_:1}),t(x,{name:"stats",label:"数据统计"},{default:s(()=>[o("div",st,[o("div",ot,[o("div",rt,[e[32]||(e[32]=o("div",{class:"stat-header"},"总用户数",-1)),o("div",nt,c(_.value.users||0),1),e[33]||(e[33]=o("div",{class:"stat-footer"},"注册用户总数",-1))]),o("div",dt,[e[34]||(e[34]=o("div",{class:"stat-header"},"总作品数",-1)),o("div",it,c(_.value.works||0),1),e[35]||(e[35]=o("div",{class:"stat-footer"},"已发布作品",-1))]),o("div",ut,[e[36]||(e[36]=o("div",{class:"stat-header"},"总课程数",-1)),o("div",pt,c(_.value.courses||0),1),e[37]||(e[37]=o("div",{class:"stat-footer"},"已上架课程",-1))]),o("div",ct,[e[38]||(e[38]=o("div",{class:"stat-header"},"总订单数",-1)),o("div",mt,c(_.value.orders||0),1),e[39]||(e[39]=o("div",{class:"stat-footer"},"已完成订单",-1))]),o("div",vt,[e[40]||(e[40]=o("div",{class:"stat-header"},"总积分",-1)),o("div",ft,c(_.value.totalPoints||0),1),e[41]||(e[41]=o("div",{class:"stat-footer"},"用户积分总和",-1))]),o("div",gt,[e[42]||(e[42]=o("div",{class:"stat-header"},"总收入",-1)),o("div",yt,"¥"+c(_.value.totalRevenue||0),1),e[43]||(e[43]=o("div",{class:"stat-footer"},"订单总收入",-1))])]),e[44]||(e[44]=o("div",{class:"charts-section"},[o("div",{class:"chart-card"},[o("h3",null,"近7天注册用户"),o("div",{class:"chart-placeholder"},"图表区域（需要集成图表库）")]),o("div",{class:"chart-card"},[o("h3",null,"收入趋势"),o("div",{class:"chart-placeholder"},"图表区域（需要集成图表库）")])],-1))])]),_:1})]),_:1},8,["modelValue"])]),t(De,{modelValue:C.value,"onUpdate:modelValue":e[25]||(e[25]=a=>C.value=a),title:"添加课程",width:"600px",onClose:ce},{footer:s(()=>[o("span",bt,[t(m,{onClick:e[24]||(e[24]=a=>C.value=!1)},{default:s(()=>[...e[48]||(e[48]=[u("取消",-1)])]),_:1}),t(m,{type:"primary",onClick:ze,loading:j.value},{default:s(()=>[...e[49]||(e[49]=[u(" 确认添加 ",-1)])]),_:1},8,["loading"])])]),default:s(()=>[t(qe,{ref_key:"courseFormRef",ref:V,model:r,rules:ge,"label-width":"100px"},{default:s(()=>[t(f,{label:"课程标题",prop:"title"},{default:s(()=>[t(b,{modelValue:r.title,"onUpdate:modelValue":e[16]||(e[16]=a=>r.title=a),placeholder:"请输入课程标题"},null,8,["modelValue"])]),_:1}),t(f,{label:"课程描述",prop:"description"},{default:s(()=>[t(b,{modelValue:r.description,"onUpdate:modelValue":e[17]||(e[17]=a=>r.description=a),type:"textarea",rows:3,placeholder:"请输入课程描述"},null,8,["modelValue"])]),_:1}),t(f,{label:"讲师",prop:"teacherName"},{default:s(()=>[t(b,{modelValue:r.teacherName,"onUpdate:modelValue":e[18]||(e[18]=a=>r.teacherName=a),placeholder:"请输入讲师姓名"},null,8,["modelValue"])]),_:1}),t(f,{label:"分类",prop:"category"},{default:s(()=>[t(K,{modelValue:r.category,"onUpdate:modelValue":e[19]||(e[19]=a=>r.category=a),placeholder:"选择分类",style:{width:"100%"}},{default:s(()=>[t(v,{label:"基础入门",value:"basic"}),t(v,{label:"人像摄影",value:"portrait"}),t(v,{label:"风景摄影",value:"landscape"}),t(v,{label:"后期处理",value:"post"}),t(v,{label:"器材使用",value:"equipment"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"难度",prop:"difficulty"},{default:s(()=>[t(K,{modelValue:r.difficulty,"onUpdate:modelValue":e[20]||(e[20]=a=>r.difficulty=a),placeholder:"选择难度",style:{width:"100%"}},{default:s(()=>[t(v,{label:"入门",value:1}),t(v,{label:"中级",value:2}),t(v,{label:"高级",value:3})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"时长(分钟)",prop:"duration"},{default:s(()=>[t(me,{modelValue:r.duration,"onUpdate:modelValue":e[21]||(e[21]=a=>r.duration=a),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(f,{label:"价格",prop:"price"},{default:s(()=>[t(me,{modelValue:r.price,"onUpdate:modelValue":e[22]||(e[22]=a=>r.price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(f,{label:"是否免费",prop:"isFree"},{default:s(()=>[t(Be,{modelValue:r.isFree,"onUpdate:modelValue":e[23]||(e[23]=a=>r.isFree=a)},{default:s(()=>[t(ve,{label:0},{default:s(()=>[...e[45]||(e[45]=[u("收费",-1)])]),_:1}),t(ve,{label:1},{default:s(()=>[...e[46]||(e[46]=[u("免费",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"封面图",prop:"coverImage"},{default:s(()=>[t(Pe,{action:"/api/file/upload",headers:ye.value,"show-file-list":!1,"on-success":Te,"before-upload":Ue},{default:s(()=>[r.coverImage?(g(),fe("img",{key:0,src:r.coverImage,class:"upload-preview"},null,8,_t)):(g(),k(m,{key:1,type:"primary",plain:""},{default:s(()=>[...e[47]||(e[47]=[u("点击上传封面",-1)])]),_:1}))]),_:1},8,["headers"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ct=Ae(wt,[["__scopeId","data-v-4281425e"]]);export{Ct as default};
