import{_ as h,a as U,c as q,b as u,d as s,w as t,i as B,e as d,j as C,u as m,k as E,l as $,y as F,z as N,m as _,n as w,x as g,E as p,q as M,r as v}from"./main-BuGC26DR.js";const j={class:"register-container"},A={class:"register-card"},I={class:"register-header"},S={class:"register-footer"},T={__name:"Register",setup(Z){const x=C(),c=v(!1),f=v(),r=M({username:"",email:"",nickname:"",password:"",confirmPassword:""}),y={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度在3-50个字符之间",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],nickname:[{max:50,message:"昵称长度不能超过50个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在6-20个字符之间",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(a,e,l)=>{e!==r.password?l(new Error("两次输入的密码不一致")):l()},trigger:"blur"}]},V=async()=>{if(!(!r.username||r.username.length<3))try{(await g.get(`/user/check/username/${r.username}`)).data.data||p.error("用户名已存在")}catch(a){console.error("检查用户名失败:",a)}},k=async()=>{if(!(!r.email||!r.email.includes("@")))try{(await g.get(`/user/check/email/${r.email}`)).data.data||p.error("邮箱已被注册")}catch(a){console.error("检查邮箱失败:",a)}},b=async()=>{f.value&&await f.value.validate(async a=>{if(a){c.value=!0;try{const e=await g.post("/user/register",r),{code:l,message:n,data:i}=e.data;l===200?(p.success(n||"注册成功"),x.push("/login")):p.error(n||"注册失败")}catch(e){const l=e.response?.data?.message||"注册失败，请稍后重试";p.error(l)}finally{c.value=!1}}})};return(a,e)=>{const l=d("el-icon"),n=d("el-input"),i=d("el-form-item"),z=d("el-button"),P=d("el-link"),R=d("el-form");return U(),q("div",j,[u("div",A,[u("div",I,[s(l,{size:"40"},{default:t(()=>[s(m(E))]),_:1}),e[6]||(e[6]=u("h2",null,"注册摄友圈",-1)),e[7]||(e[7]=u("p",null,"创建您的账号，加入摄影社区",-1))]),s(R,{ref_key:"registerFormRef",ref:f,model:r,rules:y,class:"register-form",onSubmit:B(b,["prevent"])},{default:t(()=>[s(i,{prop:"username"},{default:t(()=>[s(n,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=o=>r.username=o),placeholder:"用户名","prefix-icon":m($),size:"large",onBlur:V},null,8,["modelValue","prefix-icon"])]),_:1}),s(i,{prop:"email"},{default:t(()=>[s(n,{modelValue:r.email,"onUpdate:modelValue":e[1]||(e[1]=o=>r.email=o),placeholder:"邮箱","prefix-icon":m(F),size:"large",onBlur:k},null,8,["modelValue","prefix-icon"])]),_:1}),s(i,{prop:"nickname"},{default:t(()=>[s(n,{modelValue:r.nickname,"onUpdate:modelValue":e[2]||(e[2]=o=>r.nickname=o),placeholder:"昵称（可选）","prefix-icon":m(N),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),s(i,{prop:"password"},{default:t(()=>[s(n,{modelValue:r.password,"onUpdate:modelValue":e[3]||(e[3]=o=>r.password=o),type:"password",placeholder:"密码","prefix-icon":m(_),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])]),_:1}),s(i,{prop:"confirmPassword"},{default:t(()=>[s(n,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[4]||(e[4]=o=>r.confirmPassword=o),type:"password",placeholder:"确认密码","prefix-icon":m(_),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])]),_:1}),s(i,null,{default:t(()=>[s(z,{type:"primary",size:"large",loading:c.value,"native-type":"submit",style:{width:"100%"}},{default:t(()=>[...e[8]||(e[8]=[w(" 注册 ",-1)])]),_:1},8,["loading"])]),_:1}),u("div",S,[e[10]||(e[10]=u("span",null,"已有账号？",-1)),s(P,{type:"primary",onClick:e[5]||(e[5]=o=>a.$router.push("/login"))},{default:t(()=>[...e[9]||(e[9]=[w("立即登录",-1)])]),_:1})])]),_:1},8,["model"])])])}}},H=h(T,[["__scopeId","data-v-dfca18c2"]]);export{H as default};
