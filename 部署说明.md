# 摄友圈社区系统部署说明

## 系统概述

摄友圈社区系统是一个基于Spring Boot和Vue.js的摄影社区平台，提供作品分享、课程学习、积分商城、社区互动等功能。

## 技术栈

### 后端技术栈
- **Java**: JDK 17+
- **Spring Boot**: 3.1.0
- **Spring Security**: 6.0.9
- **MyBatis-Plus**: 3.5.3.2
- **MySQL**: 8.0+
- **JWT**: 无状态认证
- **Maven**: 3.6+

### 前端技术栈
- **Vue.js**: 3.3.4
- **Vue Router**: 4.2.4
- **Pinia**: 2.1.6
- **Element Plus**: 2.4.2
- **Axios**: 1.5.0
- **Vite**: 4.4.9

## 系统架构

### 10个功能模块
1. **统一认证与授权模块** - JWT认证、角色权限管理
2. **用户中心模块** - 用户信息管理、个人资料
3. **全局文件服务模块** - 文件上传、下载、管理
4. **数据统计模块** - 用户、作品、课程统计
5. **内容管理模块** - 帖子、评论管理
6. **作品模块** - 摄影作品上传、展示、互动
7. **课程与订单模块** - 课程管理、订单处理
8. **积分与商城模块** - 积分获取、商品兑换
9. **社区互动模块** - 点赞、收藏、关注
10. **管理员后台模块** - 系统管理、数据监控

## 部署步骤

### 环境准备

#### 1. 安装JDK 17+
```bash
# 验证安装
java -version
```

#### 2. 安装Node.js 16+
```bash
# 验证安装
node -v
npm -v
```

#### 3. 安装MySQL 8.0+
```bash
# 验证安装
mysql --version
```

#### 4. 安装Maven 3.6+
```bash
# 验证安装
mvn -v
```

### 数据库配置

#### 1. 创建数据库
```sql
CREATE DATABASE shengyouquan CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

#### 2. 执行数据库脚本
```bash
# 进入数据库目录
cd 摄友圈社区系统/database

# 执行SQL脚本
mysql -u root -p shengyouquan < schema.sql
```

#### 3. 配置数据库连接
编辑 `backend/src/main/resources/application.yml`：
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/shengyouquan?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai
    username: root
    password: 123456  # 修改为你的MySQL密码
```

### 启动系统

#### 方法一：使用启动脚本（推荐）

1. **双击运行** `启动脚本.bat`
2. 按照提示操作：
   - 检查环境
   - 编译后端项目
   - 启动后端服务（http://localhost:8082）
   - 安装前端依赖
   - 启动前端服务（http://localhost:3003）

#### 方法二：手动启动

1. **启动后端服务**
```bash
cd 摄友圈社区系统/backend
mvn clean package -DskipTests
java -jar target/shengyouquan-backend-1.0.0.jar
```

2. **启动前端服务**
```bash
cd 摄友圈社区系统/frontend
npm install
npm run dev
```

### 前端部署（生产环境）

如果需要部署前端到生产环境，可以使用以下命令：

```bash
cd 摄友圈社区系统/frontend
npm install
npm run build
```

构建完成后，`dist` 目录中的文件可以部署到任何静态文件服务器（如 Nginx、Apache 等）。

**Nginx 配置示例**：
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        root /path/to/摄友圈社区系统/frontend/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
    }
    
   location /api/ {
        proxy_pass http://localhost:8082/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 访问系统

- **前端地址**: http://localhost:3003
- **后端API地址**: http://localhost:8082
- **API文档**: http://localhost:8082/swagger-ui.html

### 测试账号

#### 管理员账号
- 用户名: `admin`
- 密码: `123456`

#### 普通用户账号
- 用户名: `test`
- 密码: `123456`

## 系统功能测试

### 1. 用户认证测试
1. 访问 http://localhost:3003
2. 点击"登录"按钮
3. 输入管理员账号：admin / 123456
4. 登录成功后，页面跳转到首页

### 2. 功能模块测试

#### 作品模块
1. 登录后点击"作品"菜单
2. 点击"发布作品"按钮
3. 填写作品标题、描述
4. 上传作品图片
5. 点击"发布"按钮

#### 课程模块
1. 点击"课程"菜单
2. 浏览课程列表
3. 点击课程查看详情
4. 点击"购买课程"按钮（免费课程可直接学习）

#### 商城模块
1. 点击"商城"菜单
2. 浏览商品列表
3. 点击商品查看详情
4. 点击"兑换"按钮（需要积分）

#### 社区模块
1. 点击"社区"菜单
2. 浏览帖子列表
3. 点击帖子查看详情
4. 发表评论
5. 点赞、收藏帖子

#### 管理员后台
1. 使用管理员账号登录
2. 点击"管理"菜单
3. 管理用户、作品、课程、订单等

## 常见问题排查

### 1. 后端启动失败
**问题**: 端口被占用
**解决**: 修改 `application.yml` 中的 `server.port`

**问题**: 数据库连接失败
**解决**: 
- 检查MySQL服务是否启动
- 检查数据库用户名密码是否正确
- 检查数据库是否存在

### 2. 前端启动失败
**问题**: Node.js版本过低
**解决**: 升级Node.js到16+

**问题**: 依赖安装失败
**解决**: 
```bash
cd 摄友圈社区系统/frontend
rm -rf node_modules
npm install
```

### 3. 页面无法访问
**问题**: 前端服务未启动
**解决**: 检查终端是否显示 "VITE v4.5.14 ready"

**问题**: 代理配置错误
**解决**: 检查 `vite.config.js` 中的 proxy 配置

### 4. API请求失败
**问题**: 跨域问题
**解决**: 检查后端 `WebSecurityConfig.java` 中的 CORS 配置

**问题**: 认证失败
**解决**: 
- 检查请求头是否包含 Authorization
- 检查Token是否过期
- 重新登录获取新Token

## 系统配置说明

### 后端配置文件
**位置**: `backend/src/main/resources/application.yml`

**主要配置项**:
- 服务器端口: 8082
- 数据库连接: localhost:3306/shengyouquan
- JWT密钥: shengyouquan-secret-key-2024-12-25
- 文件上传路径: D:/uploads/shengyouquan/

### 前端配置文件
**位置**: `frontend/vite.config.js`

**主要配置项**:
- 开发服务器端口: 3003
- API代理: http://localhost:8082

## 数据备份与恢复

### 数据库备份
```bash
mysqldump -u root -p shengyouquan > backup.sql
```

### 数据库恢复
```bash
mysql -u root -p shengyouquan < backup.sql
```

## 性能优化建议

### 后端优化
1. 配置数据库连接池
2. 启用Redis缓存
3. 配置静态资源缓存
4. 使用Nginx反向代理

### 前端优化
1. 配置CDN加速
2. 启用Gzip压缩
3. 代码分割和懒加载
4. 图片压缩和懒加载

## 安全建议

1. **修改默认密码**: 修改管理员和测试用户的默认密码
2. **更新JWT密钥**: 修改 `application.yml` 中的JWT密钥
3. **限制文件上传**: 限制上传文件类型和大小
4. **启用HTTPS**: 生产环境启用HTTPS
5. **定期备份**: 定期备份数据库和重要数据

## 技术支持

如有问题，请查看以下文档：
- `README.md` - 项目概述
- `系统测试说明.md` - 详细测试指南
- `项目完成总结.md` - 项目技术总结

## 部署完成

恭喜！您已成功部署摄友圈社区系统。现在可以开始使用系统的所有功能了。

**系统访问地址**:
- 前端: http://localhost:3003
- 后端API: http://localhost:8082
- API文档: http://localhost:8082/swagger-ui.html

**测试账号**:
- 管理员: admin / 123456
- 普通用户: test / 123456
